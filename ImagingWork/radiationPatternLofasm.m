function [radPatternEW,radPatternNS] = radiationPatternLofasm(freqRange,hRange)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Calculate Radiation Pattern
%-------------------------------------------------------------------------%
% Parametric Model for the LWA-1 Dipole Response
% as a Function of Frequency
% Jayce Dowell, December 20, 2011



% freqRange in Hz, should be column vector
% hRange is in hours, should be row vector
hRange = abs(hRange*pi/12); % hRange in radians, should be between 0 -> pi/2
hRange(hRange>(pi/2)) = pi/2;
% hRange(hRange<(-pi/2)) = -pi/2;

% order coefficient of the best-fit polynomial to parameters
n = 0:12;

%-------------------------------------------------------------------------%
% Parameters for the E-W Polynomial Fit, E-Plane
% n x alphaE, betaE, gammaE, deltaE
paramEW = ...
[-4.52993117e1,  -3.06669173e1,  7.11119215e1,   1.13133864e1; ...
1.72359627e2,   1.37253656e2,   -2.66450447e2,  -3.49394214e1; ...
-2.72231145e2,  -2.36812145e2,  4.34395314e2,   5.15975841e1; ...
2.40840205e2,   2.30204067e2,   -3.99317541e2,  -4.15253296e1; ...
-1.33458904e2,  -1.41481412e2,  2.31201599e2,   2.01675350e1; ...
4.91727832e1,   5.82026204e1,   -8.95219193e1,  -6.17004450; ...
-1.24468312e1,  -1.65245801e1,  2.39640798e1,   1.18515334; ...
2.19501789,     3.28135779,     -4.50046389,    -1.31123436e-1; ...
-2.69033938e-1, -4.54784465e-1, 5.91991295e-1,  4.85003070e-3; ...
2.24360464e-2,  4.31144732e-2,  -5.34525601e-2, 7.05653618e-4; ...
-1.21164337e-3, -2.66518597e-3, 3.15745524e-3,  -1.10253297e-4; ...
3.81017942e-5,  9.68125738e-5,  -1.09924322e-4, 6.25032736e-6; ...
-5.27717636e-7, -1.56774660e-6, 1.71052917e-6,  -1.35050619e-7].';

alphaEW = sum(paramEW(1,:) .* (freqRange/10e6).^n, 2);
betaEW = sum(paramEW(2,:) .* (freqRange/10e6).^n, 2);
gammaEW = sum(paramEW(3,:) .* (freqRange/10e6).^n, 2);
deltaEW = sum(paramEW(4,:) .* (freqRange/10e6).^n, 2);
%-------------------------------------------------------------------------%


%-------------------------------------------------------------------------%
% Parameters for the N-S Polynomial Fit, E-Plane
% n x alphaE, betaE, gammaE, deltaE
paramNS = ...
[-4.67361577e1, -2.57168497e1,  7.34504958e1,   1.24757325e1; ...
1.78607828e2,   1.19265801e2,   -2.75675572e2,  -3.90944288e1; ...
-2.83829202e2,  -2.09443099e2,  4.49916361e2,   5.78116652e1; ...
2.52963340e2,   2.07255881e2,   -4.14005911e2,  -4.66413118e1; ...
-1.41420083e2,  -1.29712536e2,  2.39939691e2,   2.27329249e1; ...
5.26474299e1,   5.43283141e1,   -9.29836961e1,  -6.98369609; ...
-1.34868710e1,  -1.56942887e1,  2.49071652e1,   1.34698313; ...
2.41161359,     3.16832358,     -4.67973532,    -1.49509056e-1; ...
-3.00382150e-1, -4.46022164e-1, 6.15741005e-1,  5.50337619e-3; ...
2.55284141e-2,  4.29105053e-2,  -5.56027389e-2, 8.21322904e-4; ...
-1.40995103e-3, -2.68962173e-3, 3.28431557e-3,  -1.28207933e-4; ...
4.55549817e-5,  9.89863473e-5,  -1.14320770e-4, 7.28724548e-6; ...
-6.52303480e-7, -1.62285564e-6, 1.77843040e-6,  -1.57929065e-7].';

alphaNS = sum(paramNS(1,:) .* (freqRange/10e6).^n, 2);
betaNS = sum(paramNS(2,:) .* (freqRange/10e6).^n, 2);
gammaNS = sum(paramNS(3,:) .* (freqRange/10e6).^n, 2);
deltaNS = sum(paramNS(4,:) .* (freqRange/10e6).^n, 2);
%-------------------------------------------------------------------------%


radPatternEW = (1 - (2*hRange/pi).^alphaEW) .* cos(hRange).^betaEW + ...
    gammaEW .* (2*hRange/pi) .* cos(hRange).^deltaEW;

radPatternNS = (1 - (2*hRange/pi).^alphaNS) .* cos(hRange).^betaNS + ...
    gammaNS .* (2*hRange/pi) .* cos(hRange).^deltaNS;

% radPatternEW = real(radPatternEW);
% radPatternNS = real(radPatternNS);

end
%-------------------------------------------------------------------------%
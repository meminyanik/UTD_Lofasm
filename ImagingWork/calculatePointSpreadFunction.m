function PSF = calculatePointSpreadFunction(tgExact,decInd,raInd,fStart,fStop)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Define Frequency Range
%-------------------------------------------------------------------------%
fc = (0.09765625*fStart:0.09765625:0.09765625*fStop)'*1e6;
%-------------------------------------------------------------------------%

nsF = 69.5;
thao = nsF/(100e6);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Calculate Simulated AB Data - Method 2
%---------------------------------------------------------------------%
phaseComp = 0;
[~,~,~,hSize] = size(tgExact);
tgT = reshape(tgExact(decInd,raInd,:,:),6,hSize);
for nA = 1:6
    phaseComp = phaseComp + exp(-2*pi*1i*fc*(tgT(nA,:)-thao));
end
ABlT = conj(phaseComp);
%---------------------------------------------------------------------%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Subtract Related Frequency and Time Range
%-------------------------------------------------------------------------%
ABlT = ABlT(fStart:fStop,:);
% [fSize, ~] = size(ABlT);
%-------------------------------------------------------------------------%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Antenna Coordinates
%-------------------------------------------------------------------------%
mainLongMap = -116.793272;
%-------------------------------------------------------------------------%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Find the number of days from J2000.0 for 05:45:11 hrs UT on 2016 July 21th
%-------------------------------------------------------------------------%
startHour = 05 + 45/60 + 11/3600;
fractionDay = startHour / 24;
dayNum = 21;
daysSinceJanuary = 182;
daysSinceJ2000 = 5842.5;
numOfDays = daysSinceJ2000 + daysSinceJanuary + dayNum + fractionDay;

% Find the Local Siderial Time (LST) of Each Antenna
lstMain = 100.46 + 0.985647 * numOfDays + mainLongMap + 15*startHour;
lstMain = mod(lstMain,360);
%-------------------------------------------------------------------------%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Define Declination (in degrees)
%-------------------------------------------------------------------------%
dec = linspace(0,80,50);
dSize = length(dec);
%-------------------------------------------------------------------------%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Define Right Ascention (in degrees and hours)
%-------------------------------------------------------------------------%
rA = (linspace(0,90,100) + lstMain)*12/180;
rSize = length(rA);
%-------------------------------------------------------------------------%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Calculate PSF
%-------------------------------------------------------------------------%
PSF = zeros(dSize,rSize);

nsF = 69.5;
thao = nsF/(100e6);
for dD = 1:dSize
    for rR = 1:rSize

        tgT = reshape(tgExact(dD,rR,:,:),6,hSize);
        
        phaseComp = 0;
        for nA = 1:6
            phaseComp = phaseComp + exp(-2*pi*1i*fc*(tgT(nA,:)-thao));
        end
        
        PSF(dD,rR) = sum(sum(ABlT .* phaseComp));
    end
end
%-------------------------------------------------------------------------%

mesh(abs(PSF),'FaceColor','interp','LineStyle','none')
view(2)
colormap('jet');